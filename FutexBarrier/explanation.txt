Мы используем futex, чтобы прочитать переменную внутри критической секции, т.е. чтобы никто другой его в этот момент не менял, и чтобы записать ее тоже внутри критической секции, чтобы никто не читал неисправленное значение. Поэтому в lock нужно сделать acquire барьер, чтобы переменная не считалась до критической секции, а в unlock - release барьер, чтобы запись произошла до выхода из критической секции.
Барьеры слабее делать нельзя, т.к. тогда futex будет бесполезен, ведь не будет выполняться то, что мы от него хотим(указано в начале).
Как и ожидалось, т.к. барьеры acquire-release слабее sequence-order программа, программа стала работать быстрее, однако не всегда значительно (2-10 %).